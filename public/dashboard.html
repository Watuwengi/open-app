<script src="/socket.io/socket.io.js"></script>
<script>
  const socket = io();
  const pc = new RTCPeerConnection();

  // Receive phone's screen offer
  socket.on('offer', offer => {
    pc.setRemoteDescription(offer);
    pc.createAnswer().then(answer => {
      pc.setLocalDescription(answer);
      socket.emit('answer', answer);
    });
  });

  // Show phone screen on laptop
  pc.ontrack = e => {
    document.getElementById('remote').srcObject = e.streams[0];
  };

  // SEND EMAIL LINK
  function sendLink() {
    const email = document.getElementById('email').value;
    if (!email) {
      alert('Please enter your email');
      return;
    }
    fetch('/link?email=' + encodeURIComponent(email))
      .then(r => r.text())
      .then(msg => {
        document.getElementById('status').innerHTML = '<p style="color:green;">' + msg + '</p>';
      })
      .catch(err => {
        document.getElementById('status').innerHTML = '<p style="color:red;">Error: ' + err + '</p>';
      });
  }
</script>
