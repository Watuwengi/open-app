<script src="/socket.io/socket.io.js"></script>
<script>
  const socket = io();
  const pc = new RTCPeerConnection();

  // Receive phone's screen offer
  socket.on('offer', offer => {
    pc.setRemoteDescription(offer);
    pc.createAnswer().then(answer => {
      pc.setLocalDescription(answer);
      socket.emit('answer', answer);
    });
  });

  // Display phone screen
  pc.ontrack = e => {
    document.getElementById('remote').srcObject = e.streams[0];
  };

  // Send magic link
  function sendLink() {
    const email = document.getElementById('email').value;
    if (!email) return alert('Enter your email');
    fetch('/link?email=' + encodeURIComponent(email))
      .then(r => r.text())
      .then(msg => document.getElementById('status').innerHTML = msg);
  }
</script>
